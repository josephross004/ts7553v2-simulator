# 1. Setup Index
export PIP_EXTRA_INDEX_URL=https://www.piwheels.org/simple

# 2. Block Source Builds (The "Big Three" memory killers)
pip install "pillow<11.0.0"
pip install "contourpy<1.3.0"
pip install "pandas<3.0.0"
pip install "brotli==1.1.0" 
pip install "psutil==5.9.8"

# 3. Core Dependencies
pip install matplotlib==3.8.4
pip install scipy==1.12.0
pip install meson==1.4.1 meson-python==0.16.0
pip install Cython==3.0.10 packaging==24.0 pyproject-metadata==0.8.0

# 4. Scikit-Learn (Manual Wheel)
wget https://www.piwheels.org/simple/scikit-learn/scikit_learn-1.4.2-cp311-cp311-linux_armv7l.whl
pip install scikit_learn-1.4.2-cp311-cp311-linux_armv7l.whl

# 5. Numba Stack (Assumes llvmlite 0.43.0 is built from source)
pip install numba==0.60.0
pip install librosa==0.10.2
pip install noisereduce==2.0.1

# 6. Data & PVLib
wget https://files.pythonhosted.org/packages/e7/5c/f4c088c7a04f5b7c0a532fe264de21b840d65aee619eee0d11dcc62e8b8f/pvlib-0.11.0-py3-none-any.whl
pip install pvlib-0.11.0-py3-none-any.whl

pip install dask==2024.5.0 seaborn==0.13.2 xarray==2024.3.0 openpyxl==3.1.2 py7zr==0.21.0

# 7. Final NumPy Alignment
pip uninstall -y numpy
pip install numpy==1.26.4